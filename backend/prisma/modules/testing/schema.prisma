/**
 * Sistema test e valutazioni
 * Modulo: testing
 * Generato automaticamente dalla Fase 8
 */

// === ENUM DEFINITIONS ===


// === MODEL DEFINITIONS ===
model TestDocument {
  id                String             @id @default(uuid())
  scheduledCourseId String
  trainerId         String?
  nomeFile          String
  url               String
  dataGenerazione   DateTime           @default(now())
  numeroProgressivo Int
  annoProgressivo   Int
  stato             String             @default("generato")
  tipologia         String             @default("test")
  punteggio         Float?
  durata            Int?
  note              String?
  dataTest          DateTime?
  sogliaSuperamento Float?
  deletedAt         DateTime?
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt
  scheduledCourse   CourseSchedule     @relation(fields: [scheduledCourseId], references: [id], onDelete: Cascade)
  trainer           Person?            @relation("TestDocumentTrainer", fields: [trainerId], references: [id], onDelete: Cascade)
  partecipanti      TestPartecipante[]

  @@index([scheduledCourseId])
  @@index([trainerId])
  @@map("test_documents")
}

model TestPartecipante {
  id             String       @id @default(uuid())
  testId         String
  personId       String       @map("partecipante_id") // Mapped for DB compatibility
  punteggio      Float?
  status         String       @default("da completare") @map("stato")
  note           String?
  dataConsegna   DateTime?
  tempoImpiegato Int?
  deletedAt      DateTime?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  person         Person       @relation("TestPartecipante_Person", fields: [personId], references: [id], onDelete: Cascade)
  test           TestDocument @relation(fields: [testId], references: [id], onDelete: Cascade)

  @@unique([testId, personId])
  @@index([personId])
  @@index([testId])
  @@map("test_partecipanti")
}
